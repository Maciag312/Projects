// First Name Surname: Bartlomiej Maciag
// Group: Friday 07:30
// Task: 3.2. Lab 3. LCD, Potencjometr, ADC, Wykresy

int adc = 1;
float voltage = 0.0;
char data[100];

#define BUTTON 6

#include <Wire.h> 
#include <LiquidCrystal.h>  // Aleternative vs. #include <LiquidCrystal_I2C.h> 


LiquidCrystal lcd(12, 11, 5, 4, 3, 2); //Alterative vs. LiquidCrystal_I2C lcd(0x27, 2, 1, 0, 4, 5, 6, 7, 3, POSITIVE);
float holder = 0; 

bool lastState = HIGH; 
bool curState = HIGH;
bool backlight = true; 
void setup() {
  Serial.begin(9600);
  lcd.begin(16, 2);
  pinMode(BUTTON, INPUT_PULLUP);     

  lcd.print("Miernik A0 ");
}

void loop() {
  if(backlight){
    lcd.backlight();
   // Serial.println("backlight is now on");
  }else{
    lcd.noBacklight(); 
    //Serial.println("backlight is turned off");
  }
  curState = digitalRead(BUTTON); 
  if(curState != lastState){
    delay(50);
    if(curState == LOW){
      backlight = !backlight;
    }
  }
  lastState = curState;
  lcd.setCursor(0, 1);
  adc = analogRead(A0); // reading connected potentiometer
  voltage = (adc*5)/1024.0; // calculating voltage 
  sprintf(data, "V=%d.%02d ADC=%d", (int)voltage, (int)(voltage*100)%100, adc);
  lcd.print(data);
  Serial.print(voltage); // printing voltage and backlight state in order to 
  Serial.print(",");//seperator another version is '/t' although here only ',' works
  Serial.print(backlight);
  Serial.println("");
  delay(10);
}
